# 2026-01-18

## Pickle Rick

Jag försökte för ett par dagar sedan starta det här, så början är skriven då, men jag fick problem med mina RAM, fick hårda krascher med datorn ett par gånger och nu hoppas jag att det är löst.

Jag återvänder till det här rummet, jag höll på klara av den innan jul men de ändrade i rummet så att den autofyllde i flaggor, nu verkar den ha blivit återställd så man måste manuellt skriva in flaggorna, tack och lov.

Jag laddar in IP:n i Burpsuite, jag vet sedan tidigare att det finns en robots.txt så laddar in den med, genom de här  två sakerna så får jag fram följande info som kommer vara relevant

    Note to self, remember username!
    Username: R1ckRul3s

robots.txt innehåller:

    Wubbalubbadubdub

Jag kör kommandot <code>gobuster dir -u http://10.82.146.251/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php</code>

Hittar portal.php

Loggar in med R1ckRul3s och Wubbalubbadubdub som lösenord. Pillrar runt en stund och så dog datorn, tydligen volsnap id 25, fick slut virtuellt minne. Oops.

Och nu fortsätter vi där vi slutade.

Fick köra kommandon, upptäckte två txt-filer, en av dem var första ingrediensen: **mr. meeseek hair**

Andra var clue.txt som sa "Look around the file system for the other ingredient."

Och där kraschade min VM igen.

Det slutade i ett flera timmar långt försök att klura ut problemet. Om mina AI-chattar har rätt så beror det antagligen på Virtualbox och hur de renderar grafik. Det i samband med att jag hade senaste Kali var problematiskt, så jag beslutade mig för att testa VMware istället. Så härifrån testar jag köra på min nya Kali-VM via VMware, håller tummarna att det går bättre. Den verkar då inte läka minne just nu i alla fall.

Jag tror att rummet är något trasigt eftersom den gav mig den tredje flaggan automatiskt efter jag hittade den andra flaggan.

I slutändan visade det sig att jag var tvungen att använda kommandot <code>less</code> istället för <code>cat</code> då cat var avstängt så att säga. Sedan, kryptiskt nog, var jag tvungen att använda mig av sudo för att kunna titta in i root-katalogen och hitta den tredje flaggan. Personligen upplever jag det som mindre bra design då jag inte hade något lösenord och inte behövde ett heller.



# 2026-01-15

Igår fick man klart en path, det kändes bra. Men nu hoppar vi på nästa path. Jag hade ju redan påbörjat och kommit ungefär halvvägs genom SOC Level 1 innan det blev förlegat. Såhär ser det ut idag:

![SOC Level 1 Legacy](<bilder/Skärmbild 2025-11-06 110625.png>) ![Soc Level 1 idag](<bilder/Skärmbild 2026-01-15 Soc-Level-1.png>)

Några rum är redan avklarade men nu hoppar vi in i första rummet för mig.

## SOC Role in Blue Team

Rummet handlar om att man ska förstå konceptet och syftet med det "blå laget".

Fick lära mig ett nytt begrepp för mig, MSSP - Managed Security Service Provider. Det kan bli värdefullt för praktik och jobb-sökning i framtiden.

![Soc Role in Blue Team avklarat](<bilder/Skärmbild 2026-01-15 SocRole.png>)

## Humans as Attack Vectors

Ett rum med mycket text angående hur människor är den svagaste länken i cybersäkerhet. Lite om phishing, deepfakes, cybersäkerhetsträning för all användare osv.

![Human Attack Vectors](<bilder/Skärmbild 2026-01-15 humanattackvectors.png>)

## Systems as Attack Vectors

Också ett rum med mycekt text, nu angående system och dess potentiella brister. Jag får titta på sårbarheter som kräver patchning, felkonfigurationer och hur man kan ta hand om dem.

![System Attack Vectors](<bilder/Skärmbild 2026-01-15 systemattackvectors.png>)

## SOC L1 Alert Triage

Poängen här är att jag ska förstå konceptet SOC alerts och förstå hur man utför triage som en level 1 analyst.

Det dök upp en intressant flowchart som kan vara kul att titta på framöver.

![Flowchart](bilder/SocLevel1Triage_Flowchart_THM.svg)

Jag fick leka i en väldigt enkel webversion och välja vilka alerts som var true positives och vilka som var false positives. Det var lite skoj.

![Sov Level 1 Triage](<bilder/Skärmbild 2026-01-15 SocL1Triage.png>)

## SOC L1 Alert Reporting

Här ska jag få lära mig hur man rapporterar och eskalerar ett ärende som SOC Level 1 analyst.

Jag fick skriva en rapport för en alert, min rapport:

    "Eddie Huffman, IT Manager receives a likely phishing email at 19:25 on Mar 27th. The Senders email failed the SPF and DKIM security checks. Therefor I believe this to be a true positive."

Jag fick göra ännu en rapport, den såg ut såhär:

    "The user NT AUTHORITY\SYSTEM is using suspicious commands on the DMZ-MSEXCHANGE-2013 machine at 19:56 on Mar 27th. Parent process include C:\Users\Public\revshell.exe invoked by C:\Windows\System32\inetsrv\w3wp.exe which makes me believe this is a true positive."

![Alert Reporting](<bilder/Skärmbild 2026-01-15 SocL1AlertReporting.png>)

## SOC Workbooks and Lookups

Här tittar vi på hur man bör hantera situationer, man bör kunna leta i dokumentation om användare, assets osv.

Än en gång har TryHackMe ett fint flowchart som kan vara kul att titta på.

![Flowchart Lookups](bilder/SocWorkbooksLookups_Flowchart_THM.svg)

Efter det här var det kul, man fick bygga ihop sin egen workbook i tre olika fall.

![SOC Workbooks](<bilder/Skärmbild 2026-01-15 SocWorkbooks.png>)

## SOC Metrics and Objectives

Här får jag lära mig om bl.a. Mean Time to Detect (MTTD), Mean Time to Response (MTTR) och Service Level Agreement (SLA).

Allmänt mycket text rörande saker som false positive rates och de ovan nämnda sakerna. Mot slutet fick man analysera några olika scenarior med de här koncepten.

![SOC Metrics](<bilder/Skärmbild 2026-01-15 SocMetrics.png>)

## SOC Simulator - Introduction to Phishing

Det här var roligt och jag ska nog prova göra det fler gånger, det känns som man behöver göra det några gånger för att börja få till bra poäng på ens rapporter. Jag fick 30-55/100 den här gången, inte perfekt med andra ord.

Men med tanke på att jag aldrig varit i den här miljön tidigare så är jag ganska nöjd med resultatet. Även om jag var lite stressad då jag måste röra på mig strax.

![SOC Simulator Introduction to Phishing](<bilder/Skärmbild 2026-01-15 SocSimulator_Phishing.png>)

# 2026-01-14

## OWASP Top 10 2025: IAAA Failures

Mycket läsning och förståelse, inte så mycket användning av mjukvara i det här rummet.

- #### A01: Broken Access Control

    A common occurence of this is IDOR (Insecure Direct Object Reference): if changing an ID (like ?id=7 → ?id=6) lets you see or edit someone else’s data, access control is broken.
- #### A07: Authentication Failures
    
    - Common issues include:
    - username enumeration
    - weak/guessable passwords (no lockout/rate limits)
    - logic flaws in the login/registration flow
    - insecure session or cookie handling

- #### A09: Logging & Alerting Failures
    
    When applications don’t record or alert on security-relevant events, defenders can’t detect or investigate attacks.

![Owasp 01](<bilder/Skärmbild 2026-01-14 Owasp01.png>)

## OWASP Top 10 2025: Application Design Flaws

Nu verkar vi då starta en attackbox och ett mål, så lite mer hands on får man hoppas!

- #### AS02: Security Misconfigurations
    
    Security misconfigurations happen when systems, servers, or applications are deployed with unsafe defaults, incomplete settings, or exposed services. These are not code bugs but mistakes in how the environment, software, or network is set up. They create easy entry points for attackers.

    Här fick jag navigera runt litegrann på egen hand och petade in text istället för siffror så fick jag fram flaggan: THM{V3RB0S3_3RR0R_L34K}

- #### AS03: Software Supply Chain Failures
    
    Software supply chain failures happen when applications rely on components, libraries, services, or models that are compromised, outdated, or improperly verified. These weaknesses are not inherent in your code, but rather in the software and tools you depend on. Attackers exploit these weak links to inject malicious code, bypass security, or steal sensitive data.

    Den här var riktigt krånglig. Löste den till slut men det kändes som en oerhört stor ökning i svårighetsgrad jämfört med tidigare grejer här.

    Jag löste det genom att först läsa koden som fanns i rummet, jag laddade då hem python-scriptet som nämns lite kryptiskt i rummet. Där fanns det en sektion som nämnde "@app.route('/api/process', methods=['POST'])" och där i fanns det lite information som antydde att om man skickade in "debug" som en application/json så skulle något kul hända. Så jag går in på URL:en i rummet, inspekterade med firefox inbyggda funktion. Jag valde att titta på Network-fliken och sedan gå in på URL/api/process och där behövde jag söka lite på internet för att lösa hur jag skulle få klart det hela, men jag bifogar en screenshot där man kan se att jag lagt till "Content-Type: application/json" och sedan fyllt i Body med {"data":"debug"} och då fick jag svaret!

    ![Conte-Type application/json](<bilder/Skärmbild 2026-01-14 Owasp02-software_supply_chain_failure.png>)


- #### AS04: Cryptographic Failures
    
    Cryptographic failures happen when encryption is used incorrectly or not at all. This includes weak algorithms, hard-coded keys, poor key handling, or unencrypted sensitive data. These flaws let attackers access information that should be private.

    Den här omgången var lättare för mig, det jag gjorde var att inspektera källan, se att det finns en decrypt.js-fil, jag tittar på den och där stod nyckel och vilken typ av kryptering det var (ECB) och storlek på nyckeln.

    Så jag sökte fram ett online decryption-verktyg och petade in det kodade meddelandet, nycklen osv och fick fram flaggan: THM{CRYPTO_FAILURE_H4RDCOD3D_K3Y}

- #### AS06: Insecure Design
    Insecure design happens when flawed logic or architecture is built into a system from the start. These flaws stem from skipped threat modelling, no design requirements or reviews, or accidental errors.

    Moreover, with the introduction of AI assistants, AI systems exacerbate insecure design. Developers often assume that models are safe, correct, or predictable, or that the code they produce is flaw-free. When an AI system can generate queries, write code, or classify users without limits, the risk is built into the design, leading to poor architectural patterns.

    Det här rummet var dåligt designat. Man får väldigt lite ledtrådar. Jag blev tvungen att kolla på en walkthrough för att ha en chans. Jag vet inte hur man ska kunna lista ut att man ska gå till URL/api/messages/admin för att få tag i flaggan. Även om det handlar om en dåligt designad messaging app så var det inte speciellt uppenbart. De borde skriva om instruktionerna och förklara bättre på vägen kan jag tycka, flaggan är i vilket fall som helst: THM{1NS3CUR3_D35IGN_4SSUMPT10N}

    ![Owasp 02](<bilder/Skärmbild 2026-01-14 owasp02.png>)



## OWASP Top 10 2025: Insecure Data Handling

- #### A04: Cryptographic Failures
    
    Cryptographic failures happen when sensitive data isn't adequately protected due to lack of encryption, faulty implementation, or insufficient security measures. This includes storing passwords without hashing, using outdated or weak algorithms (such as MD5, SHA1, or DES), exposing encryption keys, or failing to secure data during transmission.

    Vi har ju redan hanterat detta i ett tidigare rum idag, men de vill väl vara tydliga misstänker jag.

    Den här var mycket enkel, jag skulle gissa mig fram till vad sista symbolen var i en nyckel, och det var en siffra så jag körde en efter en och det visade sig vara 1 som var svaret, så jag fick nyckeln: THM{WEAK_CRYPTO_FLAG}

- #### A05: Injection
    
    Injection occurs when an application takes user input and mishandles it. Instead of processing the input securely, the application passes it directly into a system that can execute commands or queries, such as a database, a shell, a templating engine or API.

    Den här var lite märklig igen. Instruktionerna gav mig flaggan genom deras hjälpsektion men det förväntades att jag skulle använda ett språk jag aldrig tidigare sett på TryHackMe. Lösningen var då att navigera en SSTI-sandbox och lyckas läsa ut flaggan flag.txt, men jag förstod inte hur jag skulle börja navigera annat än att skriva in <code>{{ config.files() }}</code> för att få en enklare lista på.. något? Men till slut läste jag deras hjälp för att förstå att följande kommando <code>{{ request.application.__globals__.__builtins__.open('flag.txt').read() }}</code> gav flaggan THM{SSTI_FLAG_OBTAINED}.

    Jag kan då se på ett ungefär hur logiken i koden fungerar men hur jag nu skulle lösa det utan förkunskaper vet jag inte.

- #### A08: Software or Data Integrity Failures
    
    Software or Data Integrity Failures occur when an application relies on code, updates, or data it assumes are safe, without verifying their authenticity, integrity, or origin. This includes trusting software updates without verification, loading scripts or configuration files from untrusted sources, failing to validate data that impacts application logic, or accepting data such as binaries, templates, or JSON files without confirming whether it has been altered.

    Det blev samma här, jag var tvungen att titta på deras lösning, jag kände inte att jag riktigt hade tid att lära mig helt nya moduler och hur de fungerar exakt. Jag kan koda i Python och sätta mig in i såna här saker men jag använde mig av deras färdiga script för att få fram flaggan: THM{INSECURE_DESERIALIZATION}


Härligt, då blev man klar med första riktiga spåret på TryHackMe!

![Cyber 101 complete](<bilder/Skärmbild 2026-01-14 cyber101.png>)

# 2026-01-08

## FlareVM: Arsenal of Tools

FlareVM - "Forensics, Logic Analysis, and Reverse Engineering"

Tidigt listas en mängd verktyg som kommer förinstallerade på FlareVM. Jag skriver upp dem här för framtida undersökning. En del känner jag till sedan tidigare men många är nya för mig.

### Reverse Engineering & Debugging

- Ghidra - NSA-developed open-source reverse engineering suite.
- x64dbg - Open-source debugger for binaries in x64 and x32 formats.
- OllyDbg - Debugger for reverse engineering at the assembly level.
- Radare2 - A sophisticated open-source platform for reverse engineering.
- Binary Ninja - A tool for disassembling and decompiling binaries.
- PEiD - Packer, cryptor, and compiler detection tool.

### Disassemblers & Decompilers

- CFF Explorer - A PE editor designed to analyze and edit Portable Executable (PE) files.
- Hopper Disassembler - A Debugger, disassembler, and decompiler.
- RetDec - Open-source decompiler for machine code.

### Static & Dynamic Analysis

- Process Hacker - Sophisticated memory editor and process watcher.
- PEview - A portable executable (PE) file viewer for analysis.
- Dependency Walker - A tool for displaying an executable’s DLL dependencies.
- DIE (Detect It Easy) - A packer, compiler, and cryptor detection tool.

### Forensics & Incident Response

- Volatility - RAM dump analysis framework for memory forensics.
- Rekall - Framework for memory forensics in incident response.
- FTK Imager - Disc image acquisition and analysis tools for forensic use.

### Network Analysis

- Wireshark - Network protocol analyzer for traffic recording and examination.
- Nmap - A vulnerability detection and network mapping tool.
- Netcat - Read and write data across network connections with this helpful tool.

### File Analysis

- FileInsight - A program for looking through and editing binary files.
- Hex Fiend - Hex editor that is light and quick.
- HxD - Binary file viewing and editing with a hex editor.

### Scripting & Automation

- Python - Mainly automation-focused on Python modules and tools.
- PowerShell Empire - Framework for PowerShell post-exploitation.

### Sysinternals Suite

- Autoruns - Shows what executables are configured to run during system boot-up.
- Process Explorer - Provides information about running processes.
- Process Monitor - Monitors and logs real-time process/thread activity.

Efter jag gjort en del av uppgifterna i det här rummet så ser jag verkligen värdet i många av programmen. PEStudio känns som en solid start för statisk analys.

Tråkigt att VM:en genom TryHackMe dör så ofta. Måste starta om den för tredje eller fjärde gången nu för att bli klar med rummet.

Men i slutändan ett intressant rum där man får peta på lite allt möjligt.

![FlareVM](<bilder/Screenshot 2026-01-08 flarevm.png>)

## Training Impact on Teams
Det här verkar vara ett rum med mestadels läsning rörande hur viktigt det är med träning och utbildning inom cybersäkerhet.

Det dök upp ett oväntat matteproblem också. Det var ju lite kul.

![Training](<bilder/Screenshot 2026-01-08 training.png>)

# 2026-01-05

## REMnux: Getting Started

Här får jag lära mig om oledump.py, ett program där jag kan analyzera OLE-filer. Ett nytt koncept för mig. OLE-filer är tydligen utvecklat av Microsoft och används oftast för att lagra filer av olika datatyper som t.ex. dokument, presentationer osv.

Exempel på kommando jag använt:

    oledump.py agenttesla.xlsm -s 4 --vbadecompress

InetSim var nästa program jag fick prova på, där simulerade jag ett nätverk som jag använde för att ladda ner filer, och som TryHackMe själva sa:

What we did here is mimic a malware's behaviour, wherein it will try to reach out to a server or URL and then download a secondary file that may contain another malware.

Volatility är nästa program vi tittar på. Med det här ska man kunna undersöka vad som finns i RAM i en dator.

Exempel:

    vol3 -f wcry.mem windows.pstree.PsTree

This plugin lists processes in a tree based on their parent process ID.

Sedan fick jag göra ett litet script rakt i terminalen, det såg ut såhär:

    for plugin in windows.malfind.Malfind windows.psscan.PsScan windows.pstree.PsTree windows.pslist.PsList windows.cmdline.CmdLine windows.filescan.FileScan windows.dlllist.DllList; do vol3 -q -f wcry.mem $plugin > wcry.$plugin.txt; done

TryHackMes förklaring av scriptet:

- We created a variable named $plugin with values of each volatility plugin
- Then ran vol3 parameters -q, which means quiet mode or does not show the progress in the terminal
- And -f, which means read from the memory capture.
- The plugin > wcry.plugin.done; means run volatility with the plugins and output it to a file with wcry at the beginning of the text, followed by the name of the plugins and with an extension of .txt. Repeat until the value of variable $plugin is used.


![RemnuxVM](<bilder/Skärmbild 2026-01-05 remnuxvm.png>)
